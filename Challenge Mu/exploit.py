import socket
import sys

# Constants
n_as = 128 - len('Hello, dear ')
cmd_str = sys.argv[1].encode('ASCII')
status_str = "This computer has been running for "

# Inspired from: http://pymotw.com/2/socket/tcp.html
# Create a TCP/IP socket
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Bind the socket to the port
server_address = ('192.168.56.101', 1234)
# server_address = ('192.168.56.1', 55005)
sock.connect(server_address)

# Sends data
try:
    data = sock.recv(1024)

    message = b':' * n_as
    message += cmd_str

    sock.sendall(message)
    print(message)

    data = sock.recv(1024)
    data += sock.recv(1024)

    try:
        ans_str = data.decode('ASCII')
        status_loc = ans_str.find(status_str) + len(status_str)
        # print(data)
        print(ans_str[status_loc::])
    except:
        ans_str = data
        print("Failed to decode response! Raw dump:")
        print(ans_str)

finally:
    print("Closing socket!")
    sock.close()